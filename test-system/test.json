{
    "ddl": [],
    "migrations": [],
    "queries": [
        {
            "queryid": "10ba3c04-0f91-4ef3-a717-c1e0d33b31bc",
            "query": "WITH \"monthlyflightcounts\" AS (SELECT \"flights\".\"origin\" AS \"origin\", MONTH(\"flights\".\"flightdate\") AS \"month\", COUNT(*) AS \"totalflights\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" GROUP BY \"flights\".\"origin\", MONTH(\"flights\".\"flightdate\")), \"_q_0\" AS (SELECT \"monthlyflightcounts\".\"month\" AS \"month\", \"monthlyflightcounts\".\"origin\" AS \"origin\", RANK() OVER (PARTITION BY \"monthlyflightcounts\".\"month\" ORDER BY \"monthlyflightcounts\".\"totalflights\" DESC) AS \"airportrank\" FROM \"monthlyflightcounts\" AS \"monthlyflightcounts\") SELECT \"_q_0\".\"month\" AS \"month\", \"f\".\"origin\" AS \"origin\", CASE WHEN \"f\".\"deptimeblk\" IN ('0600-0659', '0700-0759', '0800-0859', '1600-1659', '1700-1759', '1800-1859') THEN 'Peak' ELSE 'Off-Peak' END AS \"timeofday\", COUNT(*) AS \"totalflights\", ROUND(AVG(\"f\".\"taxiout\"), 2) AS \"avgtaxiout\", ROUND(AVG(\"f\".\"depdelay\"), 2) AS \"avgdepdelay\", ROUND(AVG(\"f\".\"arrdelay\"), 2) AS \"avgarrdelay\", ROUND(CORR(\"f\".\"taxiout\", \"f\".\"depdelay\"), 2) AS \"taxiout_depdelay_correlation\", ROUND(CORR(\"f\".\"taxiout\", \"f\".\"arrdelay\"), 2) AS \"taxiout_arrdelay_correlation\", COUNT_IF(\"f\".\"depdel15\" = 1) AS \"delayedflights\", ROUND((COUNT_IF(\"f\".\"depdel15\" = 1) * 100.0 / COUNT(*)), 2) AS \"percentdelayed\" FROM \"flights\".\"public\".\"flights\" AS \"f\" JOIN \"_q_0\" AS \"_q_0\" ON \"_q_0\".\"airportrank\" <= 10 AND \"_q_0\".\"month\" = MONTH(\"f\".\"flightdate\") AND \"_q_0\".\"origin\" = \"f\".\"origin\" WHERE \"f\".\"cancelled\" = FALSE AND \"f\".\"diverted\" = FALSE GROUP BY \"_q_0\".\"month\", \"f\".\"origin\", CASE WHEN \"f\".\"deptimeblk\" IN ('0600-0659', '0700-0759', '0800-0859', '1600-1659', '1700-1759', '1800-1859') THEN 'Peak' ELSE 'Off-Peak' END ORDER BY \"month\" DESC, \"origin\" NULLS LAST, \"timeofday\" NULLS LAST"
        },
        {
            "queryid": "8abd47c0-31cb-4ba0-891f-9bac53bbc909",
            "query": "WITH \"airportdiscrepancy\" AS (SELECT COALESCE(\"flights\".\"origin\", \"flights\".\"dest\") AS \"airport\", COALESCE(\"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"airportcity\", COALESCE(\"flights\".\"originstate\", \"flights\".\"deststate\") AS \"airportstate\", CASE WHEN GROUPING(\"flights\".\"origin\") = 0 THEN 'Origin' ELSE 'Destination' END AS \"airportrole\", COUNT(*) AS \"totalflights\", AVG(\"flights\".\"actualelapsedtime\" - \"flights\".\"crselapsedtime\") AS \"avgdiscrepancy\", AVG(CASE WHEN GROUPING(\"flights\".\"origin\") = 0 THEN \"flights\".\"depdelay\" ELSE \"flights\".\"arrdelay\" END) AS \"avgdepdelay\", AVG(CASE WHEN GROUPING(\"flights\".\"origin\") = 0 THEN \"flights\".\"depdelayminutes\" ELSE \"flights\".\"arrdelayminutes\" END) AS \"avgdepdelayminutes\", AVG(CASE WHEN GROUPING(\"flights\".\"origin\") = 0 THEN \"flights\".\"taxiout\" ELSE \"flights\".\"taxiin\" END) AS \"avgtaxiout\", AVG(CAST(CASE WHEN GROUPING(\"flights\".\"origin\") = 0 THEN \"flights\".\"depdel15\" ELSE \"flights\".\"arrdel15\" END = 1 AS DOUBLE)) AS \"percentdelayeddepartures\", AVG(CAST(\"flights\".\"diverted\" AS DOUBLE)) AS \"percentdiverted\", AVG(CAST(\"flights\".\"cancelled\" AS DOUBLE)) AS \"percentcancelled\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"crselapsedtime\" > 0 AND NOT \"flights\".\"actualelapsedtime\" IS NULL AND NOT \"flights\".\"crselapsedtime\" IS NULL GROUP BY GROUPING SETS ((\"flights\".\"origin\", \"flights\".\"origincityname\", \"flights\".\"originstate\"), (\"flights\".\"dest\", \"flights\".\"destcityname\", \"flights\".\"deststate\"))), \"rankedairports\" AS (SELECT \"airportdiscrepancy\".\"airport\" AS \"airport\", \"airportdiscrepancy\".\"airportcity\" AS \"airportcity\", \"airportdiscrepancy\".\"airportstate\" AS \"airportstate\", \"airportdiscrepancy\".\"airportrole\" AS \"airportrole\", \"airportdiscrepancy\".\"totalflights\" AS \"totalflights\", \"airportdiscrepancy\".\"avgdiscrepancy\" AS \"avgdiscrepancy\", \"airportdiscrepancy\".\"avgdepdelay\" AS \"avgdepdelay\", \"airportdiscrepancy\".\"avgdepdelayminutes\" AS \"avgdepdelayminutes\", \"airportdiscrepancy\".\"avgtaxiout\" AS \"avgtaxiout\", \"airportdiscrepancy\".\"percentdelayeddepartures\" AS \"percentdelayeddepartures\", \"airportdiscrepancy\".\"percentdiverted\" AS \"percentdiverted\", \"airportdiscrepancy\".\"percentcancelled\" AS \"percentcancelled\", RANK() OVER (ORDER BY \"airportdiscrepancy\".\"avgdiscrepancy\" DESC) AS \"discrepancyrank\" FROM \"airportdiscrepancy\" AS \"airportdiscrepancy\" WHERE \"airportdiscrepancy\".\"totalflights\" > 1000) SELECT \"rankedairports\".\"airport\" AS \"airport\", \"rankedairports\".\"airportcity\" AS \"airportcity\", \"rankedairports\".\"airportstate\" AS \"airportstate\", \"rankedairports\".\"airportrole\" AS \"airportrole\", \"rankedairports\".\"totalflights\" AS \"totalflights\", ROUND(\"rankedairports\".\"avgdiscrepancy\", 2) AS \"avgdiscrepancyminutes\", ROUND(\"rankedairports\".\"avgdepdelay\", 2) AS \"avgdelayminutes\", ROUND(\"rankedairports\".\"avgdepdelayminutes\", 2) AS \"avgdelayminutesnonnegative\", ROUND(\"rankedairports\".\"avgtaxiout\", 2) AS \"avgtaxitimeminutes\", ROUND(\"rankedairports\".\"percentdelayeddepartures\" * 100, 2) AS \"percentdelayedflights\", ROUND(\"rankedairports\".\"percentdiverted\" * 100, 2) AS \"percentdivertedflights\", ROUND(\"rankedairports\".\"percentcancelled\" * 100, 2) AS \"percentcancelledflights\", \"rankedairports\".\"discrepancyrank\" AS \"discrepancyrank\" FROM \"rankedairports\" AS \"rankedairports\" WHERE \"rankedairports\".\"discrepancyrank\" <= 20 ORDER BY \"discrepancyrank\" NULLS LAST"
        },
        {
            "queryid": "38a70da3-f3f2-48e9-896d-4f9303598967",
            "query": "SELECT \"flights\".\"operating_airline\" AS \"airline\", \"flights\".\"dayofweek\" AS \"dayofweek\", COUNT(*) AS \"totalflights\", ROUND(AVG(\"flights\".\"depdelayminutes\"), 2) AS \"avgdeparturedelayminutes\", COUNT_IF(\"flights\".\"depdel15\" = 0) AS \"ontimeflights\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 0 THEN 100.0 ELSE 0.0 END), 2) AS \"ontimeperformancepercent\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"depdelayminutes\" IS NULL GROUP BY \"flights\".\"operating_airline\", \"flights\".\"dayofweek\" ORDER BY \"ontimeperformancepercent\" DESC, \"avgdeparturedelayminutes\" NULLS LAST"
        },
        {
            "queryid": "eee49065-116e-456a-83d9-0e0ef8083086",
            "query": "WITH \"majorairports\" AS (SELECT \"flights\".\"origin\" AS \"airport\", \"flights\".\"origincityname\" AS \"airportcity\", COUNT(*) AS \"totalflights\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" GROUP BY \"flights\".\"origin\", \"flights\".\"origincityname\" ORDER BY \"totalflights\" DESC LIMIT 10) SELECT \"f\".\"origin\" AS \"airport\", \"m\".\"airportcity\" AS \"airportcity\", \"f\".\"deptimeblk\" AS \"deptimeblk\", COUNT(*) AS \"totalflights\", ROUND(AVG(\"f\".\"taxiout\"), 2) AS \"avgtaxioutminutes\", ROUND(AVG(\"f\".\"depdelayminutes\"), 2) AS \"avgdeparturedelayminutes\", ROUND(CORR(\"f\".\"taxiout\", \"f\".\"depdelayminutes\"), 3) AS \"taxiout_depdelay_correlation\", COUNT_IF(\"f\".\"depdel15\" = 1) AS \"delayedflights\", ROUND(COUNT_IF(\"f\".\"depdel15\" = 1) * 100.0 / COUNT(*), 2) AS \"percentdelayed15plus\", ROUND(AVG(CASE WHEN \"f\".\"taxiout\" <= 10 THEN \"f\".\"depdelayminutes\" END), 2) AS \"avgdelay_taxiout_0_10\", ROUND(AVG(CASE WHEN \"f\".\"taxiout\" <= 20 AND \"f\".\"taxiout\" > 10 THEN \"f\".\"depdelayminutes\" END), 2) AS \"avgdelay_taxiout_11_20\", ROUND(AVG(CASE WHEN \"f\".\"taxiout\" > 20 THEN \"f\".\"depdelayminutes\" END), 2) AS \"avgdelay_taxiout_20plus\" FROM \"flights\".\"public\".\"flights\" AS \"f\" JOIN \"majorairports\" AS \"m\" ON \"f\".\"origin\" = \"m\".\"airport\" WHERE \"f\".\"cancelled\" = FALSE AND \"f\".\"deptimeblk\" IN ('0600-0659', '0700-0759', '0800-0859', '1600-1659', '1700-1759', '1800-1859') AND \"f\".\"diverted\" = FALSE AND NOT \"f\".\"depdelayminutes\" IS NULL AND NOT \"f\".\"taxiout\" IS NULL GROUP BY \"f\".\"origin\", \"m\".\"airportcity\", \"f\".\"deptimeblk\" ORDER BY \"airport\" NULLS LAST, \"deptimeblk\" NULLS LAST"
        },
        {
            "queryid": "d7e84363-86f7-47a2-851f-41a793fea732",
            "query": "SELECT \"flights\".\"origin\" AS \"airport\", \"flights\".\"origincityname\" AS \"airportcity\", \"flights\".\"originstate\" AS \"airportstate\", COUNT(*) AS \"totalflights\", COUNT_IF(\"flights\".\"depdel15\" = 1) AS \"delayedflights\", ROUND(COUNT_IF(\"flights\".\"depdel15\" = 1) * 100.0 / COUNT(*), 2) AS \"percentdelayedflights\", ROUND(AVG(\"flights\".\"depdelay\"), 2) AS \"avgdeparturedelayminutes\", ROUND(AVG(\"flights\".\"taxiout\"), 2) AS \"avgtaxioutminutes\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"depdel15\" IS NULL AND NOT \"flights\".\"depdelay\" IS NULL AND NOT \"flights\".\"taxiout\" IS NULL GROUP BY \"flights\".\"origin\", \"flights\".\"origincityname\", \"flights\".\"originstate\" HAVING COUNT(*) > 1000 ORDER BY \"percentdelayedflights\" DESC, \"avgdeparturedelayminutes\" DESC LIMIT 20"
        },
        {
            "queryid": "20eca341-19e1-4d85-a75d-07d9253ff06d",
            "query": "SELECT \"flights\".\"distancegroup\" AS \"distancegroup\", COUNT(*) AS \"totalflights\", ROUND(CORR(\"flights\".\"depdelayminutes\", \"flights\".\"arrdelayminutes\"), 3) AS \"delaycorrelation\", ROUND(AVG(\"flights\".\"depdelayminutes\"), 2) AS \"avgdeparturedelayminutes\", ROUND(AVG(\"flights\".\"arrdelayminutes\"), 2) AS \"avgarrivaldelayminutes\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 1 THEN 100.0 ELSE 0.0 END), 2) AS \"percentdelayeddepartures\", ROUND(AVG(CASE WHEN \"flights\".\"arrdel15\" = 1 THEN 100.0 ELSE 0.0 END), 2) AS \"percentdelayedarrivals\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"arrdelayminutes\" IS NULL AND NOT \"flights\".\"depdelayminutes\" IS NULL AND NOT \"flights\".\"distancegroup\" IS NULL GROUP BY \"flights\".\"distancegroup\" ORDER BY \"distancegroup\" NULLS LAST"
        },
        {
            "queryid": "aaf7984c-796c-4df7-b29f-e63362d1823d",
            "query": "SELECT CASE WHEN \"flights\".\"distance\" < 500 THEN 'Short-Haul (<500 miles)' WHEN \"flights\".\"distance\" > 1500 THEN 'Long-Haul (>1500 miles)' END AS \"flightcategory\", \"flights\".\"departuredelaygroups\" AS \"departuredelaygroups\", COUNT(*) AS \"flightcount\", ROUND(CAST(COUNT(*) AS DOUBLE) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY CASE WHEN \"flights\".\"distance\" < 500 THEN 'Short-Haul (<500 miles)' WHEN \"flights\".\"distance\" > 1500 THEN 'Long-Haul (>1500 miles)' END), 2) AS \"percentageofcategory\", ROUND(AVG(\"flights\".\"depdelayminutes\"), 2) AS \"avgdelayminutes\", ROUND(CAST(COUNT_IF(\"flights\".\"depdel15\" = 1) AS DOUBLE) * 100.0 / COUNT(*), 2) AS \"percentdelayed15plus\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND (\"flights\".\"distance\" < 500 OR \"flights\".\"distance\" > 1500) AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"departuredelaygroups\" IS NULL GROUP BY CASE WHEN \"flights\".\"distance\" < 500 THEN 'Short-Haul (<500 miles)' WHEN \"flights\".\"distance\" > 1500 THEN 'Long-Haul (>1500 miles)' END, \"flights\".\"departuredelaygroups\" ORDER BY \"flightcategory\" NULLS LAST, \"departuredelaygroups\" NULLS LAST"
        },
        {
            "queryid": "c1de9515-3da5-4440-a6d9-537e2cc4f5c8",
            "query": "WITH \"airportaggregates\" AS (SELECT \"flights\".\"dest\" AS \"destinationairport\", \"flights\".\"destcityname\" AS \"destinationcity\", \"flights\".\"deststate\" AS \"destinationstate\", \"flights\".\"arrtimeblk\" AS \"arrivaltimeblock\", \"flights\".\"distancegroup\" AS \"distancegroup\", COUNT(*) AS \"totalflights\", COUNT_IF(\"flights\".\"arrdel15\" = 1) AS \"delayedflights\", AVG(\"flights\".\"arrdelayminutes\") FILTER(WHERE \"flights\".\"arrdel15\" = 1) AS \"avgdelaydurationminutes\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"arrdel15\" IS NULL GROUP BY \"flights\".\"dest\", \"flights\".\"destcityname\", \"flights\".\"deststate\", \"flights\".\"arrtimeblk\", \"flights\".\"distancegroup\" HAVING COUNT(*) > 50), \"ratescalculation\" AS (SELECT \"airportaggregates\".\"destinationairport\" AS \"destinationairport\", \"airportaggregates\".\"destinationcity\" AS \"destinationcity\", \"airportaggregates\".\"destinationstate\" AS \"destinationstate\", \"airportaggregates\".\"arrivaltimeblock\" AS \"arrivaltimeblock\", \"airportaggregates\".\"distancegroup\" AS \"distancegroup\", \"airportaggregates\".\"totalflights\" AS \"totalflights\", \"airportaggregates\".\"avgdelaydurationminutes\" AS \"avgdelaydurationminutes\", CAST(\"airportaggregates\".\"delayedflights\" AS DOUBLE) / \"airportaggregates\".\"totalflights\" AS \"delayrate\", CAST(SUM(\"airportaggregates\".\"delayedflights\") OVER (PARTITION BY \"airportaggregates\".\"distancegroup\") AS DOUBLE) / SUM(\"airportaggregates\".\"totalflights\") OVER (PARTITION BY \"airportaggregates\".\"distancegroup\") AS \"avgdistancegroupdelayrate\" FROM \"airportaggregates\" AS \"airportaggregates\") SELECT \"ratescalculation\".\"destinationairport\" AS \"destinationairport\", \"ratescalculation\".\"destinationcity\" AS \"destinationcity\", \"ratescalculation\".\"destinationstate\" AS \"destinationstate\", \"ratescalculation\".\"arrivaltimeblock\" AS \"arrivaltimeblock\", \"ratescalculation\".\"distancegroup\" AS \"distancegroup\", \"ratescalculation\".\"totalflights\" AS \"totalflights\", ROUND(\"ratescalculation\".\"delayrate\" * 100, 2) AS \"arrivaldelayratepercent\", ROUND(\"ratescalculation\".\"avgdistancegroupdelayrate\" * 100, 2) AS \"avgdistancegroupdelayratepercent\", ROUND((\"ratescalculation\".\"delayrate\" - \"ratescalculation\".\"avgdistancegroupdelayrate\") * 100, 2) AS \"delayratedifferencefromaverage\", ROUND(\"ratescalculation\".\"avgdelaydurationminutes\", 2) AS \"avgdelaydurationminutes\" FROM \"ratescalculation\" AS \"ratescalculation\" ORDER BY \"destinationairport\" NULLS LAST, \"distancegroup\" NULLS LAST, \"arrivaltimeblock\" NULLS LAST"
        },
        {
            "queryid": "a7972ec2-5b53-4411-b5e7-cb4f9f14f25b",
            "query": "WITH \"baseagg\" AS (SELECT \"flights\".\"dest\" AS \"destinationairport\", \"flights\".\"destcityname\" AS \"destcityname\", \"flights\".\"deststate\" AS \"deststate\", \"flights\".\"arrtimeblk\" AS \"arrtimeblk\", \"flights\".\"distancegroup\" AS \"distancegroup\", COUNT(*) AS \"totalflights\", SUM(CASE WHEN \"flights\".\"arrdelayminutes\" >= 15 THEN 1 ELSE 0 END) AS \"delayedflights\", SUM(\"flights\".\"arrdelayminutes\") AS \"totaldelayminutes\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"arrdelayminutes\" IS NULL GROUP BY \"flights\".\"dest\", \"flights\".\"destcityname\", \"flights\".\"deststate\", \"flights\".\"arrtimeblk\", \"flights\".\"distancegroup\"), \"distancegroupaverages\" AS (SELECT \"baseagg\".\"distancegroup\" AS \"distancegroup\", CAST(SUM(\"baseagg\".\"delayedflights\") AS DOUBLE) / SUM(\"baseagg\".\"totalflights\") AS \"avgdelayrate\" FROM \"baseagg\" AS \"baseagg\" GROUP BY \"baseagg\".\"distancegroup\") SELECT \"baseagg\".\"destinationairport\" AS \"destinationairport\", \"baseagg\".\"destcityname\" AS \"destinationcity\", \"baseagg\".\"deststate\" AS \"destinationstate\", \"baseagg\".\"arrtimeblk\" AS \"arrtimeblk\", \"baseagg\".\"distancegroup\" AS \"distancegroup\", \"baseagg\".\"totalflights\" AS \"totalflights\", ROUND((CAST(\"baseagg\".\"delayedflights\" AS DOUBLE) / \"baseagg\".\"totalflights\") * 100, 2) AS \"arrivaldelayratepercent\", ROUND(\"dga\".\"avgdelayrate\" * 100, 2) AS \"avgdistancegroupdelayratepercent\", ROUND(((CAST(\"baseagg\".\"delayedflights\" AS DOUBLE) / \"baseagg\".\"totalflights\") - \"dga\".\"avgdelayrate\") * 100, 2) AS \"delayratedifferencefromaverage\", ROUND(CASE WHEN (CAST(\"baseagg\".\"totaldelayminutes\" AS DOUBLE) / \"baseagg\".\"totalflights\") >= 15 THEN (CAST(\"baseagg\".\"totaldelayminutes\" AS DOUBLE) / \"baseagg\".\"totalflights\") END, 2) AS \"avgdelaydurationminutes\" FROM \"baseagg\" AS \"baseagg\" JOIN \"distancegroupaverages\" AS \"dga\" ON \"baseagg\".\"distancegroup\" = \"dga\".\"distancegroup\" WHERE \"baseagg\".\"totalflights\" > 50 ORDER BY \"baseagg\".\"destinationairport\" NULLS LAST, \"baseagg\".\"distancegroup\" NULLS LAST, \"baseagg\".\"arrtimeblk\" NULLS LAST"
        },
        {
            "queryid": "207ef12b-a027-4624-9ac5-0231bfeda82b",
            "query": "WITH \"city_pair_aggregates\" AS (SELECT \"flights\".\"origincityname\" AS \"origincityname\", \"flights\".\"destcityname\" AS \"destcityname\", COUNT(*) AS \"total_flights\", COUNT_IF(\"flights\".\"cancelled\") AS \"cancelled_flights\", COUNT_IF(\"flights\".\"month\" IN (12, 1, 2)) AS \"winter_flights\", COUNT_IF(\"flights\".\"cancelled\" AND \"flights\".\"month\" IN (12, 1, 2)) AS \"winter_cancelled\", COUNT_IF(\"flights\".\"month\" IN (3, 4, 5)) AS \"spring_flights\", COUNT_IF(\"flights\".\"cancelled\" AND \"flights\".\"month\" IN (3, 4, 5)) AS \"spring_cancelled\", COUNT_IF(\"flights\".\"month\" IN (6, 7, 8)) AS \"summer_flights\", COUNT_IF(\"flights\".\"cancelled\" AND \"flights\".\"month\" IN (6, 7, 8)) AS \"summer_cancelled\", COUNT_IF(\"flights\".\"month\" IN (9, 10, 11)) AS \"fall_flights\", COUNT_IF(\"flights\".\"cancelled\" AND \"flights\".\"month\" IN (9, 10, 11)) AS \"fall_cancelled\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" GROUP BY \"flights\".\"origincityname\", \"flights\".\"destcityname\" HAVING COUNT(*) > 100) SELECT \"city_pair_aggregates\".\"origincityname\" || ' â†’ ' || \"city_pair_aggregates\".\"destcityname\" AS \"citypair\", \"city_pair_aggregates\".\"origincityname\" AS \"origincityname\", \"city_pair_aggregates\".\"destcityname\" AS \"destcityname\", \"city_pair_aggregates\".\"total_flights\" AS \"totalflights\", \"city_pair_aggregates\".\"cancelled_flights\" AS \"cancelledflights\", ROUND(\"city_pair_aggregates\".\"cancelled_flights\" * 100.0 / \"city_pair_aggregates\".\"total_flights\", 2) AS \"cancellationrate\", \"city_pair_aggregates\".\"winter_flights\" AS \"winterflights\", \"city_pair_aggregates\".\"winter_cancelled\" AS \"wintercancelled\", ROUND(\"city_pair_aggregates\".\"winter_cancelled\" * 100.0 / NULLIF(\"city_pair_aggregates\".\"winter_flights\", 0), 2) AS \"wintercancellationrate\", \"city_pair_aggregates\".\"spring_flights\" AS \"springflights\", \"city_pair_aggregates\".\"spring_cancelled\" AS \"springcancelled\", ROUND(\"city_pair_aggregates\".\"spring_cancelled\" * 100.0 / NULLIF(\"city_pair_aggregates\".\"spring_flights\", 0), 2) AS \"springcancellationrate\", \"city_pair_aggregates\".\"summer_flights\" AS \"summerflights\", \"city_pair_aggregates\".\"summer_cancelled\" AS \"summercancelled\", ROUND(\"city_pair_aggregates\".\"summer_cancelled\" * 100.0 / NULLIF(\"city_pair_aggregates\".\"summer_flights\", 0), 2) AS \"summercancellationrate\", \"city_pair_aggregates\".\"fall_flights\" AS \"fallflights\", \"city_pair_aggregates\".\"fall_cancelled\" AS \"fallcancelled\", ROUND(\"city_pair_aggregates\".\"fall_cancelled\" * 100.0 / NULLIF(\"city_pair_aggregates\".\"fall_flights\", 0), 2) AS \"fallcancellationrate\" FROM \"city_pair_aggregates\" AS \"city_pair_aggregates\" ORDER BY \"cancellationrate\" DESC LIMIT 50"
        },
        {
            "queryid": "1c76f499-bc7d-4151-b832-2159698bb251",
            "query": "WITH \"routeperformance\" AS (SELECT COUNT(*) AS \"flightfrequency\", CAST(COUNT_IF(\"flights\".\"depdel15\" = 0) AS DOUBLE) / COUNT(*) AS \"ontimedeparturerate\", CAST(COUNT_IF(\"flights\".\"arrdel15\" = 0) AS DOUBLE) / COUNT(*) AS \"ontimearrivalrate\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE NOT \"flights\".\"cancelled\" AND NOT \"flights\".\"diverted\" GROUP BY \"flights\".\"origin\", \"flights\".\"dest\" HAVING COUNT(*) > 100) SELECT CORR(\"routeperformance\".\"flightfrequency\", \"routeperformance\".\"ontimedeparturerate\") AS \"frequency_departurecorrelation\", CORR(\"routeperformance\".\"flightfrequency\", \"routeperformance\".\"ontimearrivalrate\") AS \"frequency_arrivalcorrelation\", COUNT(*) AS \"totalroutesanalyzed\", MIN(\"routeperformance\".\"flightfrequency\") AS \"minroutefrequency\", MAX(\"routeperformance\".\"flightfrequency\") AS \"maxroutefrequency\", AVG(\"routeperformance\".\"flightfrequency\") AS \"avgroutefrequency\" FROM \"routeperformance\" AS \"routeperformance\""
        },
        {
            "queryid": "6eb3dac9-e27a-462c-ac95-a33eff0c2695",
            "query": "SELECT \"flights\".\"distancegroup\" AS \"distancegroup\", COUNT(*) AS \"totalflights\", ROUND(AVG(\"flights\".\"distance\"), 2) AS \"avgdistancemiles\", ROUND(AVG(\"flights\".\"airtime\"), 2) AS \"avgairtimeminutes\", ROUND(AVG(\"flights\".\"airtime\" / \"flights\".\"distance\"), 4) AS \"avgminutespermile\", ROUND(AVG(\"flights\".\"crselapsedtime\" / \"flights\".\"distance\"), 4) AS \"avgscheduledminutespermile\", ROUND((AVG(\"flights\".\"airtime\" / \"flights\".\"distance\") - MIN(CASE WHEN \"flights\".\"distancegroup\" = 1 THEN \"flights\".\"airtime\" / \"flights\".\"distance\" END)) * 100.0 / MIN(CASE WHEN \"flights\".\"distancegroup\" = 1 THEN \"flights\".\"airtime\" / \"flights\".\"distance\" END), 2) AS \"efficiencydeviationfromshortest\", ROUND(AVG(\"flights\".\"crselapsedtime\") - AVG(\"flights\".\"airtime\"), 2) AS \"avgbuffertime\", ROUND(COUNT_IF(\"flights\".\"airtime\" > \"flights\".\"crselapsedtime\") * 100.0 / COUNT(*), 2) AS \"percentflightsexceedingscheduledairtime\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"distance\" > 0 AND NOT \"flights\".\"airtime\" IS NULL AND NOT \"flights\".\"cancelled\" AND NOT \"flights\".\"crselapsedtime\" IS NULL AND NOT \"flights\".\"diverted\" GROUP BY \"flights\".\"distancegroup\" ORDER BY \"distancegroup\" NULLS LAST"
        },
        {
            "queryid": "2f4177b6-e7e6-4cf8-88a6-1bac1589c374",
            "query": "SELECT \"flights\".\"distancegroup\" AS \"distancegroup\", COUNT(*) AS \"totalflights\", COUNT_IF(\"flights\".\"cancelled\") AS \"cancelledflights\", ROUND(CAST(COUNT_IF(\"flights\".\"cancelled\") AS DOUBLE) * 100.0 / COUNT(*), 2) AS \"cancellationratepercent\", ROUND(AVG(\"flights\".\"distance\"), 2) AS \"avgdistancemiles\", ROUND(AVG(\"flights\".\"month\"), 2) AS \"avgmonth\", ROUND(AVG(\"flights\".\"dayofweek\"), 2) AS \"avgdayofweek\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" GROUP BY \"flights\".\"distancegroup\" HAVING COUNT(*) > 100 ORDER BY \"cancellationratepercent\" DESC"
        },
        {
            "queryid": "ebfe26f2-8f45-4038-9eb2-148696d26292",
            "query": "WITH \"aggregatedmetrics\" AS (SELECT \"flights\".\"operating_airline\" AS \"operating_airline\", \"flights\".\"origin\" AS \"hubairport\", COUNT(*) AS \"hubrankflightcount\", COUNT(CASE WHEN \"flights\".\"taxiout\" > 0 THEN 1 END) AS \"totalflights\", ROUND(AVG(CASE WHEN \"flights\".\"taxiout\" > 0 THEN \"flights\".\"taxiout\" END), 2) AS \"avgtaxiout\", ROUND(STDDEV(CASE WHEN \"flights\".\"taxiout\" > 0 THEN \"flights\".\"taxiout\" END), 2) AS \"taxioutstddev\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 0 AND \"flights\".\"taxiout\" > 0 THEN \"flights\".\"taxiout\" END), 2) AS \"avgtaxioutontime\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 1 AND \"flights\".\"taxiout\" > 0 THEN \"flights\".\"taxiout\" END), 2) AS \"avgtaxioutdelayed\", ROUND(SUM(CASE WHEN \"flights\".\"depdel15\" = 0 AND \"flights\".\"taxiout\" > 0 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(CASE WHEN \"flights\".\"taxiout\" > 0 THEN 1 END), 0), 2) AS \"ontimedeparturerate\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE NOT \"flights\".\"cancelled\" AND NOT \"flights\".\"diverted\" GROUP BY \"flights\".\"operating_airline\", \"flights\".\"origin\"), \"rankedhubs\" AS (SELECT \"aggregatedmetrics\".\"operating_airline\" AS \"operating_airline\", \"aggregatedmetrics\".\"hubairport\" AS \"hubairport\", \"aggregatedmetrics\".\"totalflights\" AS \"totalflights\", \"aggregatedmetrics\".\"avgtaxiout\" AS \"avgtaxiout\", \"aggregatedmetrics\".\"taxioutstddev\" AS \"taxioutstddev\", \"aggregatedmetrics\".\"avgtaxioutontime\" AS \"avgtaxioutontime\", \"aggregatedmetrics\".\"avgtaxioutdelayed\" AS \"avgtaxioutdelayed\", \"aggregatedmetrics\".\"ontimedeparturerate\" AS \"ontimedeparturerate\", RANK() OVER (PARTITION BY \"aggregatedmetrics\".\"operating_airline\" ORDER BY \"aggregatedmetrics\".\"hubrankflightcount\" DESC) AS \"hubrank\" FROM \"aggregatedmetrics\" AS \"aggregatedmetrics\" WHERE \"aggregatedmetrics\".\"hubrankflightcount\" > 100) SELECT \"rankedhubs\".\"operating_airline\" AS \"operating_airline\", \"rankedhubs\".\"hubairport\" AS \"hubairport\", \"rankedhubs\".\"totalflights\" AS \"totalflights\", \"rankedhubs\".\"avgtaxiout\" AS \"avgtaxiout\", \"rankedhubs\".\"taxioutstddev\" AS \"taxioutstddev\", \"rankedhubs\".\"avgtaxioutontime\" AS \"avgtaxioutontime\", \"rankedhubs\".\"avgtaxioutdelayed\" AS \"avgtaxioutdelayed\", \"rankedhubs\".\"ontimedeparturerate\" AS \"ontimedeparturerate\", RANK() OVER (ORDER BY \"rankedhubs\".\"avgtaxiout\" NULLS LAST) AS \"taxiefficiencyrank\" FROM \"rankedhubs\" AS \"rankedhubs\" WHERE \"rankedhubs\".\"hubrank\" = 1 AND \"rankedhubs\".\"totalflights\" > 500 ORDER BY \"taxiefficiencyrank\" NULLS LAST"
        },
        {
            "queryid": "9f984b51-91b7-4101-8cdd-77564460c3ea",
            "query": "SELECT \"flights\".\"operating_airline\" AS \"operating_airline\", CASE WHEN NOT \"flights\".\"operated_or_branded_code_share_partners\" IS NULL AND \"flights\".\"operated_or_branded_code_share_partners\" <> '' AND \"flights\".\"operated_or_branded_code_share_partners\" <> 'NA' THEN 'Code-Share Operation' ELSE 'Regular Operation' END AS \"operationtype\", COUNT(*) AS \"totalflights\", ROUND(CAST(COUNT_IF(\"flights\".\"depdel15\" = 1) AS DOUBLE) / COUNT(*) * 100, 2) AS \"departuredelayrate\", ROUND(CAST(COUNT_IF(\"flights\".\"arrdel15\" = 1) AS DOUBLE) / COUNT(*) * 100, 2) AS \"arrivaldelayrate\", ROUND(AVG(\"flights\".\"depdelayminutes\"), 2) AS \"avgdeparturedelayminutes\", ROUND(AVG(\"flights\".\"arrdelayminutes\"), 2) AS \"avgarrivaldelayminutes\", ROUND(CAST(COUNT_IF(\"flights\".\"depdel15\" = 0) AS DOUBLE) / COUNT(*) * 100, 2) AS \"ontimedeparturerate\", ROUND(CAST(COUNT_IF(\"flights\".\"arrdel15\" = 0) AS DOUBLE) / COUNT(*) * 100, 2) AS \"ontimearrivalrate\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE NOT \"flights\".\"arrdel15\" IS NULL AND NOT \"flights\".\"cancelled\" AND NOT \"flights\".\"depdel15\" IS NULL AND NOT \"flights\".\"diverted\" GROUP BY \"flights\".\"operating_airline\", CASE WHEN NOT \"flights\".\"operated_or_branded_code_share_partners\" IS NULL AND \"flights\".\"operated_or_branded_code_share_partners\" <> '' AND \"flights\".\"operated_or_branded_code_share_partners\" <> 'NA' THEN 'Code-Share Operation' ELSE 'Regular Operation' END HAVING COUNT(*) > 100 ORDER BY \"operating_airline\" NULLS LAST, \"operationtype\" NULLS LAST"
        },
        {
            "queryid": "d50a8dfe-6f77-43cc-ad6a-f3e8a18aa1e0",
            "query": "SELECT \"flights\".\"operating_airline\" AS \"operating_airline\", CASE WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9][A-Z]{4}$') THEN 'N + 1 digit + 4 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{2}[A-Z]{3}$') THEN 'N + 2 digits + 3 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9][A-Z]{3}$') THEN 'N + 1 digit + 3 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{3}[A-Z]{2}$') THEN 'N + 3 digits + 2 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{2}[A-Z]{2}$') THEN 'N + 2 digits + 2 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{4}[A-Z]$') THEN 'N + 4 digits + 1 letter' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{3}[A-Z]$') THEN 'N + 3 digits + 1 letter' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{5}$') THEN 'N + 5 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{4}$') THEN 'N + 4 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{3}$') THEN 'N + 3 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{2}$') THEN 'N + 2 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]$') THEN 'N + 1 digit' ELSE 'Other' END AS \"aircrafttypecategory\", COUNT(*) AS \"totalflights\", COUNT_IF(\"flights\".\"depdel15\" = 1) AS \"delayedflights\", ROUND(CAST(COUNT_IF(\"flights\".\"depdel15\" = 1) AS DOUBLE) * 100.0 / COUNT(*), 2) AS \"delaypercentage\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE NOT \"flights\".\"depdel15\" IS NULL AND NOT \"flights\".\"operating_airline\" IS NULL AND NOT \"flights\".\"tail_number\" IS NULL AND \"flights\".\"cancelled\" IS DISTINCT FROM TRUE AND \"flights\".\"diverted\" IS DISTINCT FROM TRUE GROUP BY \"flights\".\"operating_airline\", CASE WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9][A-Z]{4}$') THEN 'N + 1 digit + 4 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{2}[A-Z]{3}$') THEN 'N + 2 digits + 3 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9][A-Z]{3}$') THEN 'N + 1 digit + 3 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{3}[A-Z]{2}$') THEN 'N + 3 digits + 2 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{2}[A-Z]{2}$') THEN 'N + 2 digits + 2 letters' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{4}[A-Z]$') THEN 'N + 4 digits + 1 letter' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{3}[A-Z]$') THEN 'N + 3 digits + 1 letter' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{5}$') THEN 'N + 5 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{4}$') THEN 'N + 4 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{3}$') THEN 'N + 3 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]{2}$') THEN 'N + 2 digits' WHEN REGEXP_LIKE(\"flights\".\"tail_number\", '^N[0-9]$') THEN 'N + 1 digit' ELSE 'Other' END HAVING COUNT(*) > 50 ORDER BY \"operating_airline\" NULLS LAST, \"delaypercentage\" DESC"
        },
        {
            "queryid": "3e6e6491-e2ec-4741-9007-ba9580615736",
            "query": "WITH \"airline_stats\" AS (SELECT \"flights\".\"operating_airline\" AS \"operating_airline\", COUNT(*) AS \"total_flights\", COUNT_IF(\"flights\".\"depdel15\" = 1) AS \"total_delayed_departures\", COUNT_IF(\"flights\".\"arrdel15\" = 0 AND \"flights\".\"depdel15\" = 1) AS \"recovered_flights\", COUNT_IF(\"flights\".\"arrdel15\" = 1 AND \"flights\".\"depdel15\" = 1) AS \"unrecovered_flights\", AVG(CASE WHEN \"flights\".\"depdel15\" = 1 THEN \"flights\".\"depdelayminutes\" END) AS \"avg_dep_delay_for_delayed\", AVG(CASE WHEN \"flights\".\"arrdel15\" = 0 AND \"flights\".\"depdel15\" = 1 THEN \"flights\".\"depdelayminutes\" END) AS \"avg_dep_delay_for_recovered\", AVG(CASE WHEN \"flights\".\"arrdel15\" = 1 AND \"flights\".\"depdel15\" = 1 THEN (\"flights\".\"arrdelayminutes\" - \"flights\".\"depdelayminutes\") END) AS \"avg_delay_increase\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE AND NOT \"flights\".\"arrdel15\" IS NULL AND NOT \"flights\".\"depdel15\" IS NULL GROUP BY \"flights\".\"operating_airline\") SELECT \"airline_stats\".\"operating_airline\" AS \"operating_airline\", \"airline_stats\".\"total_flights\" AS \"totalflights\", \"airline_stats\".\"total_delayed_departures\" AS \"totaldelayeddepartures\", \"airline_stats\".\"recovered_flights\" AS \"recoveredflights\", \"airline_stats\".\"unrecovered_flights\" AS \"unrecoveredflights\", ROUND(\"airline_stats\".\"recovered_flights\" * 100.0 / NULLIF(\"airline_stats\".\"total_delayed_departures\", 0), 2) AS \"recoveryratepercent\", ROUND(\"airline_stats\".\"avg_dep_delay_for_delayed\", 2) AS \"avgdeparturedelayfordelayedflights\", ROUND(\"airline_stats\".\"avg_dep_delay_for_recovered\", 2) AS \"avgdeparturedelayforrecoveredflights\", ROUND(\"airline_stats\".\"avg_delay_increase\", 2) AS \"avgdelayincreaseduringflight\" FROM \"airline_stats\" AS \"airline_stats\" WHERE \"airline_stats\".\"total_delayed_departures\" > 100 ORDER BY \"recoveryratepercent\" DESC"
        },
        {
            "queryid": "b5c9bdcd-17ac-44bb-a246-756b9fad907a",
            "query": "WITH \"_q_0\" AS (SELECT \"flights\".\"flightdate\" AS \"flightdate\", \"flights\".\"distancegroup\" AS \"distancegroup\", COUNT(*) AS \"totalflights\", COUNT_IF(\"flights\".\"depdel15\" = 1) AS \"delayedflights\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE \"flights\".\"cancelled\" = FALSE AND \"flights\".\"diverted\" = FALSE GROUP BY \"flights\".\"flightdate\", \"flights\".\"distancegroup\") SELECT \"_q_0\".\"flightdate\" AS \"flightdate\", \"_q_0\".\"distancegroup\" AS \"distancegroup\", \"_q_0\".\"totalflights\" AS \"totalflights\", \"_q_0\".\"delayedflights\" AS \"delayedflights\", CASE WHEN \"_q_0\".\"distancegroup\" <= 2 THEN \"_q_0\".\"delayedflights\" * 120 ELSE 0 END AS \"estimatedpassengersshorthaul\", CASE WHEN \"_q_0\".\"distancegroup\" <= 4 AND \"_q_0\".\"distancegroup\" >= 3 THEN \"_q_0\".\"delayedflights\" * 150 ELSE 0 END AS \"estimatedpassengersmediumhaul\", CASE WHEN \"_q_0\".\"distancegroup\" >= 5 THEN \"_q_0\".\"delayedflights\" * 180 ELSE 0 END AS \"estimatedpassengerslonghaul\", \"_q_0\".\"delayedflights\" * CASE WHEN \"_q_0\".\"distancegroup\" <= 2 THEN 120 WHEN \"_q_0\".\"distancegroup\" <= 4 AND \"_q_0\".\"distancegroup\" >= 3 THEN 150 WHEN \"_q_0\".\"distancegroup\" >= 5 THEN 180 ELSE 0 END AS \"totalestimatedaffectedpassengers\", ROUND(\"_q_0\".\"delayedflights\" * 100.0 / \"_q_0\".\"totalflights\", 2) AS \"delayratepercentage\" FROM \"_q_0\" AS \"_q_0\" ORDER BY \"flightdate\" DESC, \"totalestimatedaffectedpassengers\" DESC"
        },
        {
            "queryid": "d576f288-9d34-4f78-a185-49501d43e01d",
            "query": "SELECT \"flights\".\"deptimeblk\" AS \"departuretimeblock\", COUNT(*) AS \"totalflights\", COUNT_IF(\"flights\".\"depdel15\" = 1) AS \"delayeddepartures\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 1 THEN \"flights\".\"depdelay\" END), 2) AS \"avgdeparturedelay\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 1 THEN \"flights\".\"arrdelay\" END), 2) AS \"avgarrivaldelay\", ROUND(AVG(CASE WHEN \"flights\".\"depdel15\" = 1 THEN \"flights\".\"depdelay\" - \"flights\".\"arrdelay\" END), 2) AS \"avgdelayrecoveryminutes\", ROUND(COUNT_IF(\"flights\".\"arrdelay\" < \"flights\".\"depdelay\" AND \"flights\".\"depdel15\" = 1) * 100.0 / NULLIF(COUNT_IF(\"flights\".\"depdel15\" = 1), 0), 2) AS \"percentflightsrecoveredtime\", ROUND(AVG(CASE WHEN \"flights\".\"arrdelay\" < \"flights\".\"depdelay\" AND \"flights\".\"depdel15\" = 1 THEN \"flights\".\"depdelay\" - \"flights\".\"arrdelay\" END), 2) AS \"avgminutesrecovered\", ROUND(AVG(CASE WHEN \"flights\".\"arrdelay\" >= \"flights\".\"depdelay\" AND \"flights\".\"depdel15\" = 1 THEN \"flights\".\"depdelay\" - \"flights\".\"arrdelay\" END), 2) AS \"avgdelaygrowth\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE NOT \"flights\".\"arrdelay\" IS NULL AND NOT \"flights\".\"cancelled\" AND NOT \"flights\".\"depdelay\" IS NULL AND NOT \"flights\".\"deptimeblk\" IS NULL AND NOT \"flights\".\"diverted\" GROUP BY \"flights\".\"deptimeblk\" ORDER BY SUBSTRING(\"flights\".\"deptimeblk\", 1, 2) NULLS LAST"
        },
        {
            "queryid": "4ab2b57f-2806-4eba-9ded-48630300e5b4",
            "query": "WITH \"cancellationrates\" AS (SELECT \"flights\".\"operating_airline\" AS \"operating_airline\", CASE WHEN \"flights\".\"month\" = 11 AND \"flights\".\"dayofmonth\" BETWEEN 20 AND 30 THEN 'Thanksgiving' WHEN (\"flights\".\"month\" = 1 OR \"flights\".\"month\" = 12) AND (\"flights\".\"dayofmonth\" >= 20 OR \"flights\".\"month\" = 1) AND (\"flights\".\"dayofmonth\" <= 5 OR \"flights\".\"month\" = 12) AND (\"flights\".\"dayofmonth\" <= 5 OR \"flights\".\"dayofmonth\" >= 20) THEN 'Christmas_New_Year' ELSE 'Regular' END AS \"periodtype\", ROUND(COUNT_IF(\"flights\".\"cancelled\") * 100.0 / COUNT(*), 2) AS \"cancellationrate\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" GROUP BY \"flights\".\"operating_airline\", CASE WHEN \"flights\".\"month\" = 11 AND \"flights\".\"dayofmonth\" BETWEEN 20 AND 30 THEN 'Thanksgiving' WHEN (\"flights\".\"month\" = 1 OR \"flights\".\"month\" = 12) AND (\"flights\".\"dayofmonth\" >= 20 OR \"flights\".\"month\" = 1) AND (\"flights\".\"dayofmonth\" <= 5 OR \"flights\".\"month\" = 12) AND (\"flights\".\"dayofmonth\" <= 5 OR \"flights\".\"dayofmonth\" >= 20) THEN 'Christmas_New_Year' ELSE 'Regular' END HAVING COUNT(*) > 100), \"_q_0\" AS (SELECT \"cancellationrates\".\"operating_airline\" AS \"operating_airline\", \"cancellationrates\".\"periodtype\" AS \"periodtype\", \"cancellationrates\".\"cancellationrate\" AS \"cancellationrate\", MAX(CASE WHEN \"cancellationrates\".\"periodtype\" = 'Regular' THEN \"cancellationrates\".\"cancellationrate\" END) OVER (PARTITION BY \"cancellationrates\".\"operating_airline\") AS \"regularcancellationrate\" FROM \"cancellationrates\" AS \"cancellationrates\") SELECT \"_q_0\".\"operating_airline\" AS \"operating_airline\", \"_q_0\".\"periodtype\" AS \"periodtype\", \"_q_0\".\"cancellationrate\" AS \"holidaycancellationrate\", \"_q_0\".\"regularcancellationrate\" AS \"regularcancellationrate\", \"_q_0\".\"cancellationrate\" - \"_q_0\".\"regularcancellationrate\" AS \"ratedifference\", ROUND((\"_q_0\".\"cancellationrate\" - \"_q_0\".\"regularcancellationrate\") * 100.0 / NULLIF(\"_q_0\".\"regularcancellationrate\", 0), 2) AS \"percentincrease\" FROM \"_q_0\" AS \"_q_0\" WHERE \"_q_0\".\"periodtype\" IN ('Thanksgiving', 'Christmas_New_Year') ORDER BY \"periodtype\" NULLS LAST, \"ratedifference\" DESC"
        },
        {
            "queryid": "e4b0a2ef-1155-46fd-8b66-c364ae03783f",
            "query": "WITH \"monthlydata\" AS (SELECT \"flights\".\"year\" AS \"year\", \"flights\".\"month\" AS \"month\", COUNT(*) AS \"airtrafficvolume\", AVG(\"flights\".\"depdelayminutes\") AS \"avgdeparturedelay\" FROM \"flights\".\"public\".\"flights\" AS \"flights\" WHERE (\"flights\".\"cancelled\" = FALSE OR \"flights\".\"cancelled\" IS NULL) AND (\"flights\".\"month\" <= EXTRACT(MONTH FROM CURRENT_DATE) OR \"flights\".\"month\" > EXTRACT(MONTH FROM CURRENT_DATE)) AND (\"flights\".\"month\" <= EXTRACT(MONTH FROM CURRENT_DATE) OR \"flights\".\"year\" = 2018) AND (\"flights\".\"month\" > EXTRACT(MONTH FROM CURRENT_DATE) OR \"flights\".\"year\" = 2019) AND (\"flights\".\"year\" = 2018 OR \"flights\".\"year\" = 2019) GROUP BY \"flights\".\"year\", \"flights\".\"month\") SELECT \"monthlydata\".\"year\" AS \"year\", \"monthlydata\".\"month\" AS \"month\", \"monthlydata\".\"airtrafficvolume\" AS \"airtrafficvolume\", \"monthlydata\".\"avgdeparturedelay\" AS \"avgdeparturedelay\", CORR(\"monthlydata\".\"avgdeparturedelay\", \"monthlydata\".\"airtrafficvolume\") OVER () AS \"delayvolumecorrelation\" FROM \"monthlydata\" AS \"monthlydata\" ORDER BY \"year\" NULLS LAST, \"month\" NULLS LAST"
        },
        {
            "queryid": "19b36ab4-3822-407c-9f98-fcb38bf758ba",
            "query": "WITH \"routestatsperflight\" AS (SELECT \"flights\".\"dayofweek\" AS \"dayofweek\", \"flights\".\"depdel15\" AS \"depdel15\", \"flights\".\"depdelayminutes\" AS \"depdelayminutes\", \"flights\".\"taxiout\" AS \"taxiout\", \"flights\".\"cancelled\" AS \"cancelled\", \"flights\".\"diverted\" AS \"diverted\", COUNT_IF(\"flights\".\"dayofweek\" <= 5 AND \"flights\".\"dayofweek\" >= 1) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"weekdayflights\", COUNT_IF(\"flights\".\"dayofweek\" <= 7 AND \"flights\".\"dayofweek\" >= 6) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"weekendflights\", COUNT_IF(\"flights\".\"deptimeblk\" IN ('0500-0559', '0600-0659', '0700-0759', '0800-0859', '0900-0959')) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"morningflights\", COUNT_IF(\"flights\".\"deptimeblk\" IN ('1600-1659', '1700-1759', '1800-1859', '1900-1959')) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"eveningflights\", COUNT_IF(\"flights\".\"deptimeblk\" IN ('1000-1059', '1100-1159', '1200-1259', '1300-1359', '1400-1459', '1500-1559')) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"middayflights\", COUNT_IF(\"flights\".\"deptimeblk\" IN ('2000-2059', '2100-2159', '2200-2259', '2300-2359', '0001-0559', '0000-0059', '0100-0159', '0200-0259', '0300-0359', '0400-0459')) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"midnightflights\", COUNT_IF(\"flights\".\"dest\" IN ('JFK', 'LAX', 'ORD', 'DFW', 'SFO', 'BOS', 'ATL', 'EWR', 'IAD', 'SEA') AND \"flights\".\"origin\" IN ('JFK', 'LAX', 'ORD', 'DFW', 'SFO', 'BOS', 'ATL', 'EWR', 'IAD', 'SEA')) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"businesshubflights\", COUNT_IF(\"flights\".\"dest\" IN ('LAS', 'MCO', 'FLL', 'MIA', 'BWI', 'SAN', 'HNL', 'SLC', 'TPA')) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"leisuredestinationflights\", COUNT(*) OVER (PARTITION BY \"flights\".\"origin\", \"flights\".\"dest\", \"flights\".\"origincityname\", \"flights\".\"destcityname\") AS \"totalrouteflights\" FROM \"flights\".\"public\".\"flights\" AS \"flights\"), \"delaypatterns\" AS (SELECT CASE WHEN (\"routestatsperflight\".\"weekdayflights\" * 1.0 / NULLIF(\"routestatsperflight\".\"weekendflights\", 0) > 1.5 AND (\"routestatsperflight\".\"morningflights\" + \"routestatsperflight\".\"eveningflights\") * 1.0 / (\"routestatsperflight\".\"morningflights\" + \"routestatsperflight\".\"eveningflights\" + \"routestatsperflight\".\"middayflights\" + \"routestatsperflight\".\"midnightflights\") > 0.5 AND \"routestatsperflight\".\"businesshubflights\" > 0) THEN 'Business-Heavy' WHEN (\"routestatsperflight\".\"weekendflights\" * 1.0 / NULLIF(\"routestatsperflight\".\"weekdayflights\", 0) > 0.7 AND \"routestatsperflight\".\"middayflights\" * 1.0 / (\"routestatsperflight\".\"morningflights\" + \"routestatsperflight\".\"eveningflights\" + \"routestatsperflight\".\"middayflights\" + \"routestatsperflight\".\"midnightflights\") > 0.4 AND \"routestatsperflight\".\"leisuredestinationflights\" > 0) THEN 'Leisure' ELSE 'Mixed' END AS \"routetype\", CASE WHEN \"routestatsperflight\".\"dayofweek\" BETWEEN 1 AND 5 THEN 'Weekday' ELSE 'Weekend' END AS \"daytype\", COUNT(*) AS \"totalflights\", COUNT_IF(\"routestatsperflight\".\"depdel15\" = 1) AS \"delayedflights\", ROUND(COUNT_IF(\"routestatsperflight\".\"depdel15\" = 1) * 100.0 / COUNT(*), 2) AS \"delayratepercent\", ROUND(AVG(\"routestatsperflight\".\"depdelayminutes\"), 2) AS \"avgdelayminutes\", ROUND(AVG(\"routestatsperflight\".\"taxiout\"), 2) AS \"avgtaxiout\" FROM \"routestatsperflight\" AS \"routestatsperflight\" WHERE \"routestatsperflight\".\"cancelled\" = FALSE AND \"routestatsperflight\".\"diverted\" = FALSE AND \"routestatsperflight\".\"totalrouteflights\" > 100 GROUP BY CASE WHEN (\"routestatsperflight\".\"weekdayflights\" * 1.0 / NULLIF(\"routestatsperflight\".\"weekendflights\", 0) > 1.5 AND (\"routestatsperflight\".\"morningflights\" + \"routestatsperflight\".\"eveningflights\") * 1.0 / (\"routestatsperflight\".\"morningflights\" + \"routestatsperflight\".\"eveningflights\" + \"routestatsperflight\".\"middayflights\" + \"routestatsperflight\".\"midnightflights\") > 0.5 AND \"routestatsperflight\".\"businesshubflights\" > 0) THEN 'Business-Heavy' WHEN (\"routestatsperflight\".\"weekendflights\" * 1.0 / NULLIF(\"routestatsperflight\".\"weekdayflights\", 0) > 0.7 AND \"routestatsperflight\".\"middayflights\" * 1.0 / (\"routestatsperflight\".\"morningflights\" + \"routestatsperflight\".\"eveningflights\" + \"routestatsperflight\".\"middayflights\" + \"routestatsperflight\".\"midnightflights\") > 0.4 AND \"routestatsperflight\".\"leisuredestinationflights\" > 0) THEN 'Leisure' ELSE 'Mixed' END, CASE WHEN \"routestatsperflight\".\"dayofweek\" BETWEEN 1 AND 5 THEN 'Weekday' ELSE 'Weekend' END) SELECT \"delaypatterns\".\"routetype\" AS \"routetype\", \"delaypatterns\".\"daytype\" AS \"daytype\", \"delaypatterns\".\"totalflights\" AS \"totalflights\", \"delaypatterns\".\"delayedflights\" AS \"delayedflights\", \"delaypatterns\".\"delayratepercent\" AS \"delayratepercent\", \"delaypatterns\".\"avgdelayminutes\" AS \"avgdelayminutes\", \"delaypatterns\".\"avgtaxiout\" AS \"avgtaxiout\", ROUND(\"delaypatterns\".\"delayratepercent\" - AVG(\"delaypatterns\".\"delayratepercent\") OVER (), 2) AS \"delayratevsoverallavg\" FROM \"delaypatterns\" AS \"delaypatterns\" ORDER BY \"routetype\" NULLS LAST, \"daytype\" NULLS LAST"
        }
    ]
}
